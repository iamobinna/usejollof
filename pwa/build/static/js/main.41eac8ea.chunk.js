(this.webpackJsonppwa=this.webpackJsonppwa||[]).push([[0],{257:function(e,t,n){},263:function(e,t,n){},265:function(e,t,n){},285:function(e,t,n){},483:function(e,t,n){},484:function(e,t,n){},489:function(e,t,n){},490:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(49),o=n.n(c),s=n(7),i=n(231),l=n.n(i),u=n(230),d=n.n(u),j=n(227),b=n.n(j),v=n(229),O=n.n(v),g=(n(257),n(1)),p=function(e){var t=e.currentIndex,n=e.setCurrentIndex,a=(e.user,e.setUser),c=Object(r.useState)(!1),o=Object(s.a)(c,2),i=o[0],u=o[1],j=[{id:0,icon:b.a,name:"Orders",color:"rgb(0, 158, 66)"},{id:1,icon:O.a,name:"Ongoing order",color:"rgb(0, 140, 158)"}];return Object(r.useEffect)((function(){u(!1)}),[t]),Object(g.jsx)("div",{className:"delivery-nav-container",children:Object(g.jsxs)("div",{style:{position:"relative"},children:[Object(g.jsx)("div",{onClick:function(){return u(!i)},className:" ".concat(!i&&"ham-open"," hamburger icon-acitve"),children:Object(g.jsx)(d.a,{})}),Object(g.jsxs)("div",{className:"delivery-boy-nav ".concat(!i&&"delivery-boy-nav-close"," "),children:[j.map((function(e){return Object(g.jsxs)("div",{onClick:function(){return n(e.id)},className:" ".concat(e.id===t&&"delivery-nav-active"," delivery-nav-option"),children:[Object(g.jsx)(e.icon,{className:""}),Object(g.jsx)("span",{children:e.name})]})})),Object(g.jsxs)("div",{className:"delivery-logout delivery-nav-option",onClick:function(){return a(null),localStorage.removeItem("driverData"),void window.dispatchEvent(new Event("sign-out-driver"))},children:[Object(g.jsx)(l.a,{className:""}),Object(g.jsx)("span",{children:"Log out"})]})]})]})})},h=(n(263),n(18)),f=n.n(h),x=n(17),m=n(38),y=(n(265),n(529)),S=n(533),w="",k=n(67),N=n.n(k),I=function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N.a.post("".concat(w,"/deliveryboy/login"),t);case 3:return n=e.sent,r=n.data,localStorage.setItem("driverData",JSON.stringify(r)),window.dispatchEvent(new Event("update-driver-account")),e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),console.log("error"),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),D=n(530),L=function(e){e.user;var t=e.setUser,n=Object(r.useState)(""),a=Object(s.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(""),l=Object(s.a)(i,2),u=l[0],d=l[1],j=Object(r.useState)(!1),b=Object(s.a)(j,2),v=b[0],O=b[1],p=Object(r.useState)({type:"",msg:null}),h=Object(s.a)(p,2),x=h[0],w=h[1],k=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),v){e.next=7;break}return O(!0),e.next=5,I({email:c,password:u});case 5:(r=e.sent)?(console.log("signin",r),t(r),w({type:"success",msg:"Logged in"}),O(!1)):(console.log("error"),w({type:"error",msg:"Wrong credentials"}),O(!1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:"Sign In"}),Object(g.jsx)("form",{onSubmit:k,className:"delivery-signin",children:v?Object(g.jsx)(D.a,{severity:"info",children:"Requesting Server..."}):Object(g.jsxs)(g.Fragment,{children:[x.msg&&Object(g.jsx)(D.a,{severity:x.type,children:x.msg}),Object(g.jsx)(y.a,{required:!0,value:c,onChange:function(e){return o(e.target.value)},id:"outlined-basic",label:"Email",type:"email",variant:"outlined"}),Object(g.jsx)(y.a,{required:!0,value:u,onChange:function(e){return d(e.target.value)},id:"outlined-basic",label:"Password",type:"password",variant:"outlined"}),Object(g.jsx)(S.a,{className:"sigin-btn-m",type:"submit",variant:"contained",children:"Sign In"})]})})]})},C=(n(285),n(82)),E=n.n(C),J=n(234),M=n.n(J),U=n(15),F=n(16),P=n(20),_=n(19),B=n(60),W=n.p+"static/media/van.3d8125c3.svg",z=n.p+"static/media/location.adf07021.svg",R=function(e){Object(P.a)(n,e);var t=Object(_.a)(n);function n(){var e;Object(U.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={coords:null,directions:null,origin:e.props.startLocation,destination:e.props.endLocation},e}return Object(F.a)(n,[{key:"componentDidMount",value:function(){var e=this;(new google.maps.DirectionsService).route({origin:this.state.origin,destination:this.state.destination,travelMode:google.maps.TravelMode.DRIVING},(function(t,n){if(n===google.maps.DirectionsStatus.OK){console.log(t);var r=t.routes[0].overview_path;e.setState({coords:r}),e.setState({directions:t})}else console.error("error fetching directions ".concat(t))}))}},{key:"render",value:function(){var e=this,t=Object(B.withGoogleMap)((function(t){return Object(g.jsxs)(B.GoogleMap,{defaultCenter:e.state.origin,defaultZoom:13,children:[Object(g.jsx)(B.Polyline,{path:e.state.coords,geodesic:!0,options:{strokeColor:"rgb(0,100,200)",strokeOpacity:.8,strokeWeight:5,clickable:!0}}),Object(g.jsx)(B.Marker,{icon:{url:W,scaledSize:new google.maps.Size(25,25)},position:e.state.origin}),Object(g.jsx)(B.Marker,{icon:{url:z,scaledSize:new google.maps.Size(25,25)},position:e.state.destination})]})}));return Object(g.jsx)("div",{style:{height:"100%",width:"100%"},children:Object(g.jsx)(t,{containerElement:Object(g.jsx)("div",{style:{height:"100%",width:"100%"}}),mapElement:Object(g.jsx)("div",{style:{height:"100%"}})})})}}]),n}(r.Component),q=R,T=function(e){var t=e.location,n=e.currentOrder,a=Object(r.useState)(""),c=Object(s.a)(a,2),o=(c[0],c[1]),i=Object(r.useState)(""),l=Object(s.a)(i,2),u=l[0],d=l[1],j=Object(r.useState)(""),b=Object(s.a)(j,2),v=b[0],O=b[1];Object(r.useEffect)((function(){o(t),d(t),O(n.vendorLocation.latLng)}),[]);var p=Object(B.withScriptjs)(q);return Object(g.jsxs)("div",{className:"delivery-boy-orders",children:[Object(g.jsxs)("div",{className:"map box flex",children:[console.log("redered"),Object(g.jsx)(p,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyD2N-yXRMJCZoNUsjJBlgwpH90NjjNWowI",loadingElement:Object(g.jsx)("div",{style:{height:"100%",overflow:"hidden",borderRadius:"20px",position:"relative"}}),startLocation:u,endLocation:v})]}),Object(g.jsxs)("div",{className:"delivery-order-button flex box",onClick:function(){O(n.vendorLocation.latLng)},children:[Object(g.jsx)(E.a,{}),Object(g.jsx)("h5",{children:" Pickup Location "})]}),Object(g.jsxs)("div",{className:"delivery-order-button flex box",onClick:function(){O(n.userLocation.latLng)},children:[Object(g.jsx)(E.a,{}),Object(g.jsx)("h5",{children:" Drop Location "})]}),Object(g.jsxs)("div",{className:"delivery-order-button flex box red",children:[Object(g.jsx)(M.a,{}),Object(g.jsx)("h5",{children:" Posponed order "})]})]})},A=n(157),G=(n(483),n(236)),Y=n.n(G),Z=n(235),H=n.n(Z),K=n(237),V=n.n(K),X=n(238),$=n.n(X),Q=n(239),ee=n.n(Q),te=function(){var e=Object(m.a)(f.a.mark((function e(){var t,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=JSON.parse(localStorage.getItem("driverData")),e.next=4,N.a.get("".concat(w,"/order/"),{headers:{"auth-token":t.auth_token,"driver-id":t.user._id}});case 4:return n=e.sent,r=n.data,console.log("data",r),e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=JSON.parse(localStorage.getItem("driverData")),e.next=4,N.a.get("".concat(w,"/order/get"),{headers:{"auth-token":n.auth_token,"order-id":t}});case 4:return r=e.sent,a=r.data,console.log("data",a),e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=JSON.parse(localStorage.getItem("driverData")),e.next=4,N.a.put("".concat(w,"/order/update"),t,{headers:{"auth-token":n.auth_token}});case 4:return r=e.sent,a=r.data,console.log("data",a),e.abrupt("return",a);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",null);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(e){var t=e.orders,n=e.setOrders,r=e.currentOrder,a=e.setCurrentOrder,c=e.socket;return Object(g.jsxs)("div",{className:"delivery-boy-orders",children:[Object(g.jsx)("h2",{children:"Orders"}),r?Object(g.jsx)(D.a,{severity:"info",children:'You have an ongoing order, swith to "On going order TAB"'}):Object(g.jsx)(g.Fragment,{children:t.map((function(e,o){return Object(g.jsxs)("div",{onClick:function(){return function(e){var r=t[e].open,a=Object(x.a)(t);if(r)return a[e].open=!1,void n(a);for(var c=0;c<a.length;c++)a[c].open=!1;a[e].open=!0,n(a)}(o)},className:"delivery-boy-order box ".concat(e.open&&"delivery-boy-order-active"," "),children:[Object(g.jsxs)("div",{className:"flex",children:["Parcel"===e.toDeliver?Object(g.jsx)(H.a,{}):Object(g.jsx)(Y.a,{}),Object(g.jsxs)("span",{children:[" ",e.products.foodId.name," "]})]}),Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsx)(E.a,{}),Object(g.jsxs)("span",{children:[" ",e.vendorLocation.address," "]})]}),Object(g.jsx)(V.a,{}),Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsx)(E.a,{style:{color:"rgb(0, 128, 90)"}}),Object(g.jsxs)("span",{children:[" ",e.userLocation.address," "]})]})]}),Object(g.jsxs)("div",{className:"flex",children:[Object(g.jsx)($.a,{}),Object(g.jsxs)("span",{children:[" ",e.user," "]})]}),Object(g.jsxs)("div",{className:"delivery-order-button flex box",onClick:function(){return function(e){null===r&&(a(t[e]),re(Object(A.a)(Object(A.a)({},t[e]),{},{delivering:!0})),c&&c.emit("ongoing order"))}(o)},children:[Object(g.jsx)(ee.a,{}),Object(g.jsx)("h5",{children:" Start Order "})]})]})}))})]})},ce=(n(484),n(243)),oe=function(e){var t=e.currentIndex,n=e.user,a=e.setUser,c=Object(r.useState)(null),o=Object(s.a)(c,2),i=o[0],l=o[1],u=Object(r.useState)([]),d=Object(s.a)(u,2),j=d[0],b=d[1],v=Object(r.useState)(null),O=Object(s.a)(v,2),p=O[0],h=O[1],y=Object(r.useState)(!0),S=Object(s.a)(y,2),k=S[0],N=S[1],I=Object(r.useState)(!0),C=Object(s.a)(I,2),E=C[0],J=C[1],M=Object(r.useState)(null),U=Object(s.a)(M,2),F=U[0],P=U[1],_=Object(r.useState)(!0),B=Object(s.a)(_,2),W=B[0],z=B[1],R=Object(r.useState)(null),q=Object(s.a)(R,2),A=q[0],G=q[1],Y=Object(r.useState)(!1),Z=Object(s.a)(Y,2),H=Z[0],K=Z[1],V=Object(r.useState)(!0),X=Object(s.a)(V,2),$=X[0],Q=X[1],ee=Object(r.useState)({lat:null,lng:null}),re=Object(s.a)(ee,2),oe=re[0],se=re[1];Object(r.useEffect)((function(){if(console.log("driverData",n),n&&k){var e=!0;n.user.vehicle&&null!==n.user.vehicle||(Q(!1),e=!1,G("You have not been assigned a vehicle ask partner to assign you one")),console.log("vehicle",n.user),N(!1),e&&(console.log("setting socket"),h(Object(ce.a)(w,{query:{token:n.auth_token}})),ie())}n&&null!==n||(N(!0),null!==p&&(console.log("logout fired"),p.disconnect(),h(null)),null!==F&&navigator.geolocation.clearWatch(F))}),[n]);var ie=function(){console.log("Setting navigator");var e=navigator.geolocation.watchPosition((function(e){se({lat:e.coords.latitude,lng:e.coords.longitude})}),(function(e){console.log(e),z(!1),G(e.message)}));P(e)};Object(r.useEffect)((function(){p&&p.emit("serverUpdateDriver",oe)}),[oe]);var le=function(){var e=Object(m.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p.emit("serverSaveDriver",{userID:n.user._id,location:{lat:null,lang:null}}),p.on("already-online",(function(){G("Your ID is logged in somewhere else, if it's not you contact admin"),K(!0)})),p.on("get-delivery",function(){var e=Object(m.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("order id",t),e.next=3,ne(t.orderID);case 3:(n=e.sent)&&b(j?function(e){return[].concat(Object(x.a)(e),[n])}:n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=5,te();case 5:(t=e.sent)&&(ue(t),b(t));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function ue(e){for(var t=0;t<e.length;t++)if(!0===e[t].delivering){l(e[t]);break}}return Object(r.useEffect)((function(){p&&E&&W&&(J(!1),le())}),[p,W]),n&&null!==n.user?Object(g.jsxs)("div",{className:"delivery-main",children:[A&&Object(g.jsx)(D.a,{style:{marginBottom:"10px"},severity:"info",children:A}),H||!$?Object(g.jsx)(g.Fragment,{}):Object(g.jsxs)(g.Fragment,{children:[1===t&&Object(g.jsx)(T,{socket:p,location:oe,currentOrder:i}),0===t&&Object(g.jsx)(ae,{socket:p,currentOrder:i,setCurrentOrder:l,orders:j,setOrders:b})]})]}):Object(g.jsx)("div",{className:"delivery-main",children:Object(g.jsx)(L,{user:n,setUser:a})})},se=function(){var e=Object(r.useState)(0),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(JSON.parse(localStorage.getItem("driverData"))?JSON.parse(localStorage.getItem("driverData")):null),o=Object(s.a)(c,2),i=o[0],l=o[1];return window.addEventListener("sign-out-driver",(function(){l("")})),window.addEventListener("update-account-driver",(function(){var e=JSON.parse(localStorage.getItem("driverData"))?JSON.parse(localStorage.getItem("driverData")):null;console.log("bla",e),l(e)})),Object(g.jsx)("div",{className:"pwa-container",children:Object(g.jsxs)("div",{className:"pwa",children:[Object(g.jsx)(p,{user:i,setUser:l,currentIndex:n,setCurrentIndex:a}),Object(g.jsx)(oe,{currentIndex:n,user:i,setUser:l})]})})};n(489),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,535)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(g.jsx)(a.a.StrictMode,{children:Object(g.jsx)(se,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),ie()}},[[490,1,2]]]);
//# sourceMappingURL=main.41eac8ea.chunk.js.map